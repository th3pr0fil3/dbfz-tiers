<!doctype html>
<html>
<head>
	<link rel="icon" type="image/x-icon" href= "../icon.png"/>
	<title>Tier List Maker - Smash Apps</title>
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,100italic" rel="stylesheet" type="text/css">
	<link href="newstyle.css" rel="stylesheet">
	<link href="dragula.min.css" rel="stylesheet">
</head>
<body>
	<div id="controls">
		<h1>TIER LIST MAKER - <span>neat</span></h1>
		<div id="buttons">
			<button id="screenshot">Share</button>
			<button id="hidebuttons">Hide controls</button>
			<button id="game">Change game</button>
			<button id="help">Help</button>
			<button id="reset">Reset</button>
		</div>
	</div>
	
	<div id="tablewrap"><table><tbody>
		<tr>
			<td class="labelHolder" contenteditable="true"><span class="label">S</span></td>
			<td><div class="tier sort" id="rows"></div></td>
			<td><div id="settings"></div><div id="moveButtons"><div id="moveUp"></div><div id="moveDown"></div></div></td>
		</tr>
		<tr>
			<td class="labelHolder" contenteditable="true"><span class="label">A</span></td>
			<td><div class="tier sort" id="rows"></div></td>
			<td><div id="settings"></div><div id="moveButtons"><div id="moveUp"></div><div id="moveDown"></div></div></td>
		</tr>
		<tr>
			<td class="labelHolder" contenteditable="true"><span class="label">B</span></td>
			<td><div class="tier sort" id="rows"></div></td>
			<td><div id="settings"></div><div id="moveButtons"><div id="moveUp"></div><div id="moveDown"></div></div></td>
		</tr>
		<tr>
			<td class="labelHolder" contenteditable="true"><span class="label">C</span></td>
			<td><div class="tier sort" id="rows"></div></td>
			<td><div id="settings"></div><div id="moveButtons"><div id="moveUp"></div><div id="moveDown"></div></div></td>
		</tr>
		<tr>
			<td class="labelHolder" contenteditable="true"><span class="label">D</span></td>
			<td><div class="tier sort" id="rows"></div></td>
			<td><div id="settings"></div><div id="moveButtons"><div id="moveUp"></div><div id="moveDown"></div></div></td>
		</tr>
		<tr>
			<td class="labelHolder" contenteditable="true"><span class="label">E</span></td>
			<td><div class="tier sort" id="rows"></div></td>
			<td><div id="settings"></div><div id="moveButtons"><div id="moveUp"></div><div id="moveDown"></div></div></td>
		</tr>
		<tr>
			<td class="labelHolder" contenteditable="true"><span class="label">F</span></td>
			<td><div class="tier sort" id="rows"></div></td>
			<td><div id="settings"></div><div id="moveButtons"><div id="moveUp"></div><div id="moveDown"></div></div></td>
		</tr>
	</tbody></table>
	</div>
	
	<div id="char" class="sort">
		<div>If no characters are loaded here, choose a game by clicking the "Change game" button above.</div>
	</div>
	
	<div id="overlay">
		<div id="modalWrapper">
			<div id="modal">
				<h1>SETTINGS</h1>
				<span id="close"></span>
				<p>Choose label color:</p>
				<div id="colorselect"><span style="background:#FF7F7F"></span><span style="background:#FFBF7F"></span><span style="background:#FFDF7F"></span><span style="background:#FFFF7F"></span><span style="background:#BFFF7F"></span><span style="background:#7FFF7F"></span><span style="background:#7FFFFF"></span><span style="background:#7FBFFF"></span><span style="background:#7F7FFF"></span><span style="background:#FF7FFF"></span><span style="background:#BF7FBF"></span><span style="background:#3B3B3B"></span><span style="background:#858585"></span><span style="background:#CFCFCF"></span><span style="background:#F7F7F7"></span></div>
				<p>Label name:</p><textarea id="labelName"></textarea>
				<p>Row functions:</p>
				<p><button id="deleteRow">Delete row</button> <button id="clearRow">Clear row</button></p>
				<p><button id="addRowUp">Add row above</button> <button id="addRowBelow">Add row below</button></p>
			</div>
			<div id="gameChange">
				<h1>CHANGE GAME</h1>
				<span id="close"></span>
				<div id="switchButtons">
					<button id="switch64">Super Smash Bros. 64</button>
					<button id="switchMelee">Super Smash Bros. Melee</button>
					<button id="switchBrawl">Super Smash Bros. Brawl</button>
					<button id="switchSmash4">Super Smash Bros. 4 (Screenshots)</button>
					<button id="switchSSB4Renders">Super Smash Bros. 4 (Renders)</button>
					<button id="switchSSB4Inktober">Super Smash Bros. 4 (Inktober 2017)</button>
					<button id="switchSSBU">Super Smash Bros. Ultimate (In Progress)</button>
					<button id="switchPM">Project M</button>
					<button id="switchSSF1">Super Smash Flash</button>
					<button id="switchSSF2Photos">Super Smash Flash 2</button>
					<button id="switchSSF2Delta">SSF2: Delta</button>
					<button id="switchCrusade">Project Crusade</button>
					<button id="switchBrawlMinus">Brawl Minus</button>
					<button id="switchBrawlZeus">Brawl Zeus</button>
					<button id="switchRoA">Rivals Of Aether</button>
					<button id="switchUSF2">Street Fighter II Series</button>
					<button id="switchSF33S">Street Fighter III Series</button>
					<button id="switchUSF4">Street Fighter IV Series</button>
					<button id="switchSFV">Street Fighter V: Champion Edition</button>
					<button id="switchMKX">Mortal Kombat X (In Progress)</button>
					<button id="switchMK11">Mortal Kombat 11 (In Progress)</button>
					<button id="switchINJ">Injustice: Gods Among Us (In Progress)</button>
					<button id="switchINJ2">Injustice 2</button>
					<button id="switchDBFZ">Dragon Ball FighterZ</button>
					<button id="switchGGREV">Guilty Gear Xrd -Revelator-</button>
					<button id="switchBrawlhalla">Brawlhalla</button>
					<button id="switchCorrinMode">SSB4 - Corrin Mode</button>
					<button id="switchOW">Overwatch</button>
				</div>
				<p><strong>Changing your game will empty your tierlist!</strong> Do not click unless you are sure you want to change! You cannot undo this.</p>
				<p>64, Melee, Brawl, and Smash 4 screenshot icons from <a href="http://ssbwiki.com">SmashWiki</a>. Smash 4 render icons made by /u/wafflepotamus. Project M screenshot icons made by /u/brewster_the_pigeon. SSF2 screenshot icons made by /u/AxeEnding999, SSF2 Photos and Crusade made b /u/CSwooly and the Project Crusade Dev Team res. Brawl Minus icons made by /u/mslb99. Street Fighter V icons from <a href="http://sfv-wiki.com/wiki/STREET_FIGHTER_V_Wiki">SFV-Wiki</a>. Guilty Gear screenshot from <a href="http://www.dustloop.com/wiki/index.php/Guilty_Gear_Xrd_-REVELATOR-">Dustloop GG Rev Wiki</a>. Overwatch icons made by Blizzard Entertainment.</p>
			</div>
			<div id="helpMenu">
				<h1>HELP</h1>
				<span id="close"></span>
				<p>This is the new version of the old Smash Tier List Maker. If you still like the old one, <a href="old/">click here</a> to go there.</p>
				<p><strong>All 4 official Smash games and Project M are supported.</strong> If you want to change the game you are using, click on "Change game" in the top bar.</p>
				<p><strong>You can take screenshots of your tierlist.</strong> To take a screenshot, click on the "Share" button in the top bar. A popup should appear that contains an image of your tierlist. You can copy or save this image to then upload to an image hosting site. If the screenshot feature does not work for you, you can click the "Hide controls" button to make the list look cleaner.</p>
				<p><strong>You can share editable versions of your tierlist.</strong> Click on the "Share" button and you will see a textbox that contains a code. Copy and share this with others so that they can edit your tierlist.</p>
				<p><strong>Your latest tierlist autosaves to your device.</strong> As soon as you drag a character image, your tierlist will be saved. Any time you reopen it you will be able to access your previous tierlist.</p>
				<p>There is a gear next to each tier in the tierlist. (If you don't see this gear, click on the "Toggle screenshot mode" button in the top bar. If this doesn't work, <a href="https://www.reddit.com/message/compose?to=Buizbuiz&subject=Smash%20Tier%20List%20Maker">message /u/Buizbuiz on reddit</a>.) If you click on it, you can <strong>change the color of the tier label, add rows, delete the row, or remove all of the characters currently in the row.</strong></p>
				<p>Next to the gear are 2 arrows, pointed up and down. Clicking these will let you <strong>move a tier up and down a level</strong>.</p>
				<p><strong>You can change the name of the tier.</strong> Click on the tier label, you can type in there. If this doesn't work, you can change it in the textbox in the corresponding settings menu.</p>
				<p>If you want to <strong>completely start over</strong>, just refresh the page.</a>
			</div>
			<div id="screenshotShow">
				<span id="close"></span>
				<p>Your image should appear above. You can copy or save this image. Try uploading it to an image hosting website such as <a href="http://imgur.com">Imgur</a>. Alternatively, copy the code below to share an editable version of your tierlist. Just paste a code into the box below and click "Run code" to access it.</p>
			<textarea id="exportcode" cols="30" rows="8"></textarea><div><button id="runCode">Run code</button></div>
			</div>
		</div>
	</div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script src="dragula.min.js"></script>
	<script src="html2canvas.js"></script>
	<script>
		dragula({
			isContainer: function (el) {
				return el.classList.contains('sort');
			}
		}).on("drop", function() {
			localStorage.setItem("TierListMakerCode",toCode());
		});
		
		// character images
		var singleChar = "<div class='character'></div>";
		var gameSmash4 = ["ssb4","mario","luigi","peach","bowser","yoshi","rosalinaluma","bowserjr","drmario","wario","donkeykong","diddykong","mrgamewatch","littlemac","link","zelda","sheik","ganondorf","toonlink","samus","zerosuitsamus","pit","palutena","darkpit","marth","ike","robin","lucina","roy","corrin","duckhunt","kirby","kingdedede","metaknight","fox","falco","pikachu","charizard","lucario","jigglypuff","greninja","mewtwo","rob","ness","lucas","captainfalcon","villager","olimar","wiifittrainer","shulk","pacman","megaman","ryu","sonic","cloud","bayonetta","miibrawler1","miigunner1","miisword1","miibrawler","miigunner","miisword"];
		var gameSSB4Renders = ["ssb4r","mario","luigi","peach","bowser","yoshi","rosalinaluma","bowserjr","wario","donkeykong","diddykong","mrgamewatch","littlemac","link","zelda","sheik","ganondorf","toonlink","samus","zerosuitsamus","pit","palutena","marth","ike","robin","duckhunt","kirby","kingdedede","metaknight","fox","falco","pikachu","charizard","lucario","jigglypuff","greninja","rob","ness","captainfalcon","villager","olimar","wiifittrainer","shulk","drmario","darkpit","lucina","pacman","megaman","sonic","mewtwo","lucas","roy","ryu","cloud","corrin","bayonetta","miibrawler1","miigunner1","miisword1","miibrawler","miigunner","miisword"];
		var gameSSB4Inktober = ["ssb4inktober","mario","luigi","peach","bowser","yoshi","rosalina","bowserjr","drmario","wario","dk","diddykong","gameandwatch","littlemac","link","zelda","sheik","ganondorf","toonlink","samus","zerosuitsamus","pit","palutena","darkpit","marth","ike","robin","lucina","roy","corrin","duckhunt","kirby","dedede","metaknight","fox","falco","pikachu","charizard","lucario","jigglypuff","greninja","mewtwo","rob","ness","lucas","falcon","villager","olimar","wiifittrainer","shulk","pacman","megaman","ryu","sonic","cloud","bayonetta","miibrawler","miigunner","miiswordfighter","miibrawler1111","miigunner1111","miiswordfighter1111"];
		var gameSSBU = ["SSBU", "mario", "dk", "link", "samus", "darksamus","yoshi", "kirby", "fox", "pikachu", "luigi", "ness", "captainfalcon", "jigglypuff", "peach", "daisy", "bowser", "iceclimbers", "sheik", "zelda", "drmario", "pichu", "falco", "marth", "lucina", "younglink", "ganondorf", "mewtwo", "roy", "chrom","gameandwatch", "metaknight", "pit", "darkpit", "zss", "wario", "snake", "ike", "pokemontrainer", "squirtle", "ivysaur", "charizard", "diddykong", "lucas", "sonic", "kingdedede", "olimar", "lucario", "rob", "toonlink", "wolf", "villager", "megaman", "wiifittrainer", "rosalina", "littlemac", "greninja", "miibrawler", "miigunner", "miiswordfighter", "palutena", "pacman", "robin", "shulk", "bowserjr", "duckhunt", "ryu", "ken", "cloud", "corrin", "bayonetta", "inkling", "ridley", "simon", "richter","kingkrool","isabelle","incineroar","piranhaplant","joker","hero","banjokazooie","terry","byleth","minmin","dlc","dlc","dlc","dlc","dlc"];
		var gameMelee = ["melee","drmario","mario","luigi","bowser","peach","yoshi","dk","falcon","ganon","falco","fox","ness","icies","kirby","samus","zelda","sheik","link","ylink","pichu","pikachu","jigglypuff","mewtwo","gnw","marth","roy"];
		var game64 = ["64","luigi","mario","dk","link","samus","falcon","ness","yoshi","kirby","fox","pikachu","jigglypuff"];
		var gameBrawl = ["brawl","mario","luigi","peach","bowser","donkeykong","diddykong","yoshi","wario","link","zelda","sheik","ganondorf","toonlink","samus","zerosuitsamus","pit","iceclimbers","rob","kirby","metaknight","kingdedede","olimar","fox","falco","wolf","captainfalcon","pikachu","pokemontrainer","lucario","jigglypuff","marth","ike","ness","lucas","mrgamewatch","snake","sonic"];
		var gamePM = ["pm","wario","mario","luigi","peach","bowser","yoshi","donkeykong","diddykong","falcon","wolf","fox","falco","icies","zelda","sheik","link","toonlink","ganon","mewtwo","lucario","pikachu","jigglypuff","squirtle","ivysaur","charizard","samus","zerosuit","lucas","ness","pit","kirby","metaknight","dedede","ike","marth","roy","olimar","rob","gnw","snake","sonic"];
		var gameBrawlMinus = ["bminus","mario","luigi","peach","bowser","yoshi","donkeykong","diddy","wario","waluigi","link","zelda","sheik","ganondorf","toonlink","samus","zss","ness","lucas","pikachu","jigglypuff","pichu","mewtwo","squirtle","ivysaur","charizard","lucario","kirby","dedede","mk","fox","falco","wolf","marth","roy","ike","captainfalcon","gnw","iceclimbers","rob","pit","olimar","snake","sonic"];
		var gameBrawlZeus = ["zeus","mario","luigi","peach","koopa","yoshi","dk","dd","wario","link","zelda","sheik","ganon","tlik","samus","zss","ness","lucas","pikachu","pichu","purin","m2","zenigame","fushigisou","lizardon","lucario","kirby","ddd","MK","fox","falco","wolf","marth","roy","ike","lucina","wayu","cf","gw","rob","pit","olimar","snake","sonic","4cloud","blackpit","cloudminus","geno","knuckles","lyn","mac","meta","ridley","ryu","shadow","shulk"];
		var gameUSF2 = ["USF2","akuma","balrog","blanka","cammy","chun-li","dee-jay","dhalsim","ehonda","evil-ryu", "fei-long","guile","ken","m-bison","ryu","sagat","t-hawk","vega","violent-ken","zangief"];
		var gameSF33S = ["SF33S","akuma","alex","chun-li","dudley","elena","hugo","ibuki","ken","makoto","necro","oro","q","remy","ryu","sean","twelve","urien","yang","yun"];
		var gameUSF4 = ["USF4","abel","adon","akuma","balrog","blanka","cammy","chunli","cody","cviper","dan","decapre","deejay","dudley","ehonda","elena","elfuerte","evilryu","feilong","gen","gouken","guile","guy","hakan","ibuki","juri","ken","makoto","mbison","oni","poison","rolento","rose","rufus","ryu","sagat","sakura","seth","thawk","vega","yang","yun","zangief"];
		var gameSFV = ["sfv","abigail","alex","akuma","balrog","birdie","blanka","cammy","chunli","cody","dhalsim","ed", "ehonda","falke","fang","g","gill","guile","ibuki","juri","kage","karin","ken","kolin","laura","lucia","mbison","menat","nash","necalli","poison","rashid","rmika","ryu","sagat","sakura","seth","urien","vega","zangief","zeku"];
		var gameGGREV = ["ggrev","axl","bedman","chipp","elphelt","faust","ino","jacko","jam","johnny","kum","ky","leo","may","millia","potemkin","ramlethal","raven","sin","slayer","sol","venom","zato1","dizzy"];
		var gameMKX = ["MKX"];
		var gameMK11 = ["MK11","baraka","cassie-cage","cetrion","dvorah","erron-black","frost","geras","jacqui","jade","jax","johnny-cage","joker","kabal","kano","kitana","kollector","kotal-kahn","kung-lao","liu-kang","nightwolf","noob-saibot","raiden","scorpion","shang-tsung","shao-kahn","sindel","skarlet","sonya","spawn","sub-zero","terminator"]
		var gameDBFZ = ["DBFZ","gokussj","krillin","piccolo","teengohan","vegetassj","frieza","trunks","android16","android18","cell","majinbuu","gokublue","vegetablue","yamcha","tien","nappa","captainginyu","gotenks","adultgohan","kidbuu","beerus","hit","gokublack","android21","bardock","broly","fusedzamasu","vegitoblue","goku","vegeta","cooler","android17","jiren","videl","gokugt","janemba","gogetablue","brolydbs","kefla","gokuui","masterroshi","superbaby2","gogetassj4","android21labcoat"];
		var gameINJ = ["INJ"];
		var gameINJ2 = ["INJ2","batman","superman","wonderwoman","supergirl","aquaman","atrocitus","gorillagrodd","deadshot","harleyquinn","theflash","bluebeetle","bane","poisonivy","braniac","robin","blackcanary","swampthing","catwoman","cheetah","cyborg","doctorfate","greenlantern","firestorm","greenarrow","blackadam","captaincold","scarecrow","darkseid","joker","redhood","starfire","subzero","blackmanta","raiden","hellboy","atom","enchantress","leonardo","michelangelo","donatello","raphael"];
		var gameSSF1 = ["SSF1","mario", "luigi", "link", "zelda", "sheik", "younglink", "samus", "kirby", "metaknight", "fox", "pikachu", "jigglypuff", "mewtwo", "falcon", "mrgameandwatch", "sonic", "tails", "knuckles", "shadow", "supersonic", "megamanx", "zero", "lloyd", "cloud", "crono", "inuyasha", "naruto", "mrincredible", "blade", "blue"];
		var gameSSF2Delta = ["SSF2Delta","mario","luigi","peach","bowser","yoshi","classicyoshi","wario","dk","link","zelda","sheik","shielda","captainfalcon","pikachu","jigglypuff","pichu","kirby","metaknight","bandanadee","fox","falco","samus","zss","ness","marth","pit","isaac","chibirobo","mrgameandwatch","sonic","tails","megaman","pacman","lloyd","bomberman","blackmage","sora","goku","luffy","ichigo","naruto","sandbag","fancypantsman"]
		var gameSSF2Photos = ["SSF2Photos","Mario","Luigi","Peach","Bowser","Yoshi","Wario","waluigi","DK","Link","Zelda","Sheik","Shielda","Ganondorf","Falcon","Pikachu","Jigglypuff","SSF2Pichu","lucario","Kirby","MetaKnight","BandanaDee","Fox","Falco","krystal","Samus","ZSS","Ness","Marth","Pit","Isaac","ChibiRobo","MrGameAndWatch","Sonic","Tails","MegaMan","ryu","PAC-MAN","Lloyd","simonssf2","Bomberman","BlackMage","Sora","rayman","Goku","Luffy","Naruto","Ichigo","Sandbag"];
		var gameCrusade = ["crusade","mario", "drmario", "luigi", "peach", "toad", "bowser", "petey", "waluigi", "wario", "ashley", "dk", "yoshi", "geno", "pikachu", "pichu", "jigglypuff", "mewtwo", "lucario", "lucarioauraless", "snivy", "samus", "zss", "ridley", "link", "linkskills", "toonlink", "ganondorf", "tingle", "olimar", "marth", "lucina", "roy", "fox", "falco", "krystal", "falcon", "kirby", "gooey", "metaknight", "ness", "lucas", "porky", "littlemac", "littlemacwiiu", "saki", "iceclimbers", "solopopo", "sona", "rob", "duckhuntdog", "machrider", "mrgameandwatch", "snake", "bomberman", "sonic", "tails", "knuckles", "shadow", "ristar", "shantae", "negashantae", "rayman", "crash", "megaman", "ryu", "evilryu", "chunli", "phoenix", "pacman", "klonoa", "goku"]
		var gameCorrinMode = ["ssb4r","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm","corrinm"];
		var gameOW = ["ow","ana","bastion","brigitte","doomfist","dva","genji","hanzo","junkrat","lucio","mccree","mei","mercy","orisa","pharah","reaper","reinhardt","roadhog","soldier","sombra","symmetra","torbjorn","tracer","widowmaker","winston","wreckingball","zarya","zenyatta"];
		var gameBrawlhalla = ["bh","ada","asuri","azoth","barraza","bodvar","brynn","cassidy","diana","ember","gnash","hattori","jhala","koji","kor","lordvraxx","lucien","orion","queennai","ragnir","scarlet","sentinel","sirroland","teros","thatch","ulgrim","val","wushang","axe","bow","gauntlet","gun","hammer","katar","lance","spear","sword"];
		var gameRoA = ["RoA","zetterburn", "orcane", "wrastor", "kragg", "forsburn", "maypul", "absa", "etalus", "oriandsein", "ranno", "clairen","sylvanos","elliana","shovelknight"];
		
		var singleTier = "<tr><td class='labelHolder' contenteditable='true' style='background-color:#FFFF7F'><span class='label'>NEW</span></td><td><div class='tier sort' id='rows'><div class='hiddenkid'></div></div></td><td><div id='settings'></div><div id='moveButtons'><div id='moveUp'></div><div id='moveDown'></div></div></td></tr>";
		
		var screenshotMode = false;
		var colors = ["#FF7F7F","#FFBF7F","#FFDF7F","#FFFF7F","#BFFF7F","#7FFF7F","#7FFFFF","#7FBFFF","#7F7FFF","#FF7FFF","#BF7FBF","#3B3B3A","#858585","#CFCFCF","#F7F7F7"];
		// first is the row in the table of the tier, second is the index of its color
		var tierDefaults = [ [$("tr:nth-of-type(1)"), 0],
					  [$("tr:nth-of-type(2)"), 1],
					  [$("tr:nth-of-type(3)"), 3],
					  [$("tr:nth-of-type(4)"), 5],
					  [$("tr:nth-of-type(5)"), 7],
					  [$("tr:nth-of-type(6)"), 8],
					  [$("tr:nth-of-type(7)"), 9] ];
		var tier = []; // format: [element, color id]
		var tierlist = [];
		var currentTier; // i mean come on!
		var tempTier;
		var tierIndex;
		var currentColor;
		var colorIndex;
		var currentGame;
		var currentGameChars = gameSSBU;
		var characters;
		var resized,tableWidth;
					  
		for (var i = 0; i < tierDefaults.length; i++) {
			tierDefaults[i][0].find(".labelHolder").css("background",colors[tierDefaults[i][1]]);
		}
			
		$(document).on("click", "#settings", function() { // open settings modal
			currentTier = $(this).parent().parent();
			currentColor = currentTier.find(".labelHolder").css("background-color");
			$("textarea").val(currentTier.find(".labelHolder").text());
			colorIndex = colors.indexOf(rgb2hex(currentColor).toUpperCase());
			tier = [currentTier, colorIndex];
			console.log(tier);
			for (var i = 0; i < $("#modal span").length; i++) {
				$("#modal span:nth-of-type("+(i+1)+")").attr("class","nope");
			}
			$("#modal span:nth-of-type("+(colorIndex+1)+")").attr("class","selected");
			$("#modal").css("display","block");
			$("#overlay").css("opacity", 1);
			$("#overlay").css("visibility", "visible");
			$("#modal").css("top",alignPopup($("#modal")));
		});
		
		$(document).on("click", "#game", function() { // open game changer modal
			$("#gameChange").css("display","block");
			$("#overlay").css("opacity", 1);
			$("#overlay").css("visibility", "visible");
			$("#gameChange").css("top",alignPopup($("#gameChange")));
		});
		
		$(document).on("click", "#help", function() { // open help modal
			$("#helpMenu").css("display","block");
			$("#overlay").css("opacity", 1);
			$("#overlay").css("visibility", "visible");
			$("#helpMenu").css("top",alignPopup($("#helpMenu")));
		});
		
		$(document).on("click", "#colorselect span", function() { // change row label
			for (var i = 0; i < $("#modal span").length; i++) {
				$("#modal span:nth-of-type("+(i+1)+")").attr("class","nope");
			}
			$(this).attr("class","selected");
			currentTier.find(".labelHolder").css("background-color",$(this).css("background-color"));
			updateTiers();
		});
		
		$(document).on("click", "#gameChange button", function() { // change game
			console.log("game switching");
			switch($(this).attr("id")) {
				case "switch64": changeGame(game64);break;
				case "switchMelee": changeGame(gameMelee);break;
				case "switchBrawl": changeGame(gameBrawl);break;
				case "switchPM": changeGame(gamePM);break;
				case "switchBrawlMinus": changeGame(gameBrawlMinus);break;
				case "switchBrawlZeus": changeGame(gameBrawlZeus);break;
				case "switchSmash4": changeGame(gameSmash4);break;
				case "switchSSBU": changeGame(gameSSBU);break;
				case "switchSSB4Renders": changeGame(gameSSB4Renders);break;
				case "switchSSB4Inktober": changeGame(gameSSB4Inktober);break;
				case "switchUSF2": changeGame(gameUSF2);break;
				case "switchSF33S": changeGame(gameSF33S);break;
				case "switchUSF4": changeGame(gameUSF4);break;
				case "switchSFV": changeGame(gameSFV);break;
				case "switchGGREV": changeGame(gameGGREV);break;
				case "switchSSF1": changeGame(gameSSF1);break;
				case "switchSSF2Delta": changeGame(gameSSF2Delta);break;
				case "switchSSF2Photos": changeGame(gameSSF2Photos);break;
				case "switchCrusade": changeGame(gameCrusade);break;
				case "switchBrawlhalla": changeGame(gameBrawlhalla);break;
				case "switchCorrinMode": changeGame(gameCorrinMode);break;
				case "switchMKX": changeGame(gameMKX);break;
					case "switchMK11": changeGame(gameMK11);break;
				case "switchDBFZ": changeGame(gameDBFZ);break;
				case "switchINJ": changeGame(gameINJ);break;
				case "switchINJ2": changeGame(gameINJ2);break;
				case "switchRoA": changeGame(gameRoA);break;
				case "switchOW": changeGame(gameOW);break;
			}
		});
			
		$(document).on("click", function(e) {
			clicked = e.target.id;
			if(clicked == "overlay" || clicked == "modalWrapper" || clicked == "close") { // close modals
				$("#overlay").css("opacity", 0);
				$("#overlay").css("visibility", "hidden");
				$("#modal").css("display", "none");
				$("#gameChange").css("display", "none");
				$("#helpMenu").css("display", "none");
				$("#screenshotShow").css("display", "none");
			} else if(clicked == "screenshot") { // take a screenshot
				$("#exportcode").val(toCode());
				$("#modal").css("display", "none");
				$("#gameChange").css("display", "none");
				$("#helpMenu").css("display", "none");
				$("#screenshotShow canvas").remove();
				$("#screenshotShow").css("display","block");
				$("#overlay").css("opacity", 1);
				$("#overlay").css("visibility", "visible");
				$("td:last-of-type").css("display","none");
				html2canvas($("table"), {
				  onrendered: function(canvas) {
					$("#screenshotShow span").after(canvas);
					$("td:last-of-type").css("display","table-cell");
					$("#screenshotShow").css("top",alignPopup($("#screenshotShow")));
				  }
				});
			} else if(clicked == "hidebuttons") { // hide the buttons
				if (screenshotMode) {
					$("td:last-of-type").css("display","table-cell");
					$("#hidebuttons").text("Hide controls");
					screenshotMode = false;
				} else {
					$("td:last-of-type").css("display","none");
					$("#hidebuttons").text("Show controls");
					screenshotMode = true;
				}
			} else if(clicked == "clearRow") { // put characters in this row back into the box
				for(var i = 0; i < currentTier.find("#rows div").length; i++) {
					$("#char div:last-child").after(currentTier.find("#rows div"));
				}
			} else if(clicked == "deleteRow") { // delete this row
				for(var i = 0; i < currentTier.find("#rows div").length; i++) {
					$("#char div:last-child").after(currentTier.find("#rows div"));
				}
				currentTier.remove();
				updateTiers();
				$("#overlay").css("opacity", 0);
				$("#overlay").css("visibility", "hidden");
				$("#modal").css("display", "none");
			} else if (clicked == "addRowUp") { // add a row on top of the current row
				$("tr:nth-of-type("+($("tr").index(currentTier)+1)+")").before(singleTier);
				updateTiers();
			} else if (clicked == "addRowBelow") { // add a row below the current row
				$("tr:nth-of-type("+($("tr").index(currentTier)+1)+")").after(singleTier);
				updateTiers();
			} else if (clicked == "moveUp") { // move the row above the row above it
				currentTier = $(e.target).closest("tr");
				if (currentTier.prev("tr").length != 0)
					currentTier.insertBefore(currentTier.prev("tr"));
			} else if (clicked == "moveDown") { // move the row below the row below it
				currentTier = $(e.target).closest("tr");
				if (currentTier.next("tr").length != 0)
					currentTier.insertAfter(currentTier.next("tr"));
			} else if (clicked == "runCode") {
				loadCode($("#exportcode").val());
			} else if (clicked == "reset") {
				switch(currentGameChars[0]) {
					case "64": changeGame(game64);break;
					case "melee": changeGame(gameMelee);break;
					case "brawl": changeGame(gameBrawl);break;
					case "bminus": changeGame(gameBrawlMinus);break;
					case "zeus": changeGame(gameBrawlZeus);break;
					case "pm": changeGame(gamePM);break;
					case "ssb4": changeGame(gameSmash4);break;
					case "SSB4Inktober": changeGame(SSB4Inktober);break;
					case "SSBU": changeGame(gameSSBU);break;
					case "USF2": changeGame(gameUSF2);break;
					case "SF33S": changeGame(gameSF33S);break;
					case "USF4": changeGame(gameUSF4);break;
					case "sfv": changeGame(gameSFV);break;
					case "ggrev": changeGame(gameGGREV);break;
					case "SSF1": changeGame(gameSSF1);break;
					case "SSF2Delta": changeGame(gameSSF2Delta);break;
					case "SSF2Photos": changeGame(gameSSF2Photos);break;
					case "MKX": changeGame(gameMKX);break;
						case "MK11": changeGame(gameMK11);break;
					case "DBFZ": changeGame(gameDBFZ);break;
					case "INJ": changeGame(gameINJ);break;
					case "INJ2": changeGame(gameINJ2);break;
					case "bh": changeGame(gameBrawlhalla);break;
					case "RoA": changeGame(gameRoA);break;
					case "ow": changeGame(gameOW);break;
					case "crusade": changeGame(gameCrusade);break;
				}
				loadCode(currentGameChars[0]+"==S|0==A|1==B|3==C|5==D|7==E|8==F|9");
			}
		});
		
		$("#labelName").bind("input propertychange", function() {
			currentTier.find(".label").html($("#labelName").val().replace(/\n/g, "<br>"));
		});
		
		// http://stackoverflow.com/a/3971432 thanks Zack Katz :D
		function rgb2hex(rgb) {
			rgb = rgb.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/);
			function hex(x) {
				return ("0" + parseInt(x).toString(16)).slice(-2);
			}
			return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
		}
		
		function updateTiers() {
			tierlist = [];
			tempTier = currentTier;
			for (var i = 0; i < $("tr").length; i++) {
				currentTier = $("tr:nth-of-type("+(i+1)+")");
				currentColor = currentTier.find(".labelHolder").css("background-color"); // returns in rgb format, have to convert to hex
				tier[0] = currentTier;
				tier[1] = colors.indexOf(rgb2hex(currentColor).toUpperCase());
				console.log(tier);
				tierlist.push(tier);
			}
			currentTier = tempTier;
			console.log(tierlist);
		}
		
		function changeGame(game) {
			currentGameChars = [];
			currentGameChars = game;
			currentGame = game[0];
			$(".character").each( function() {
				$(this).remove();
			});
			for (var i = 1; i < game.length; i++) {
				$("#char div:last-child").after(singleChar);
				$("#char div:last-child").css("background-image","url(img/"+currentGame+"/"+game[i]+".png)");
				$("#char div:last-child").attr("id",i);
			}
			$("h1 span").text(currentGame);
			updateTiers();
		}
		
		function toCode() { // format game==label|color|char1|char2|...==label|color|char1|char2|...==...
			var codeColors = [], labels = [], currentChars = [], shareCode = "";
			characters = [];
			$("tr").each( function() {
				currentChars = [];
				labels.push($(this).find(".label").html());
				codeColors.push(colors.indexOf(rgb2hex($(this).find(".labelHolder").css("background-color")).toUpperCase()));
				$(this).find(".character").each( function() {
					currentChars.push($(this).attr("id"));
				});
				characters.push(currentChars);
			});
			shareCode += currentGame + "==";
			for (var i = 0; i < labels.length; i++) {
				shareCode += labels[i] +"|"+ codeColors[i];
				if (characters[i].length != 0)
					shareCode += "|";
				for (var c = 0; c < characters[i].length; c++) {
					shareCode += characters[i][c];
					if (c != characters[i].length-1)
						shareCode += "|";
				}
				if (i != labels.length-1)
					shareCode += "==";
			}
			console.log(shareCode);
			return shareCode;
		}
		
		function loadCode(code) {
			var codeSplit = [], tempTier = [], processedCode = [];
			codeSplit = code.split("==");
			for (var i = 0; i < codeSplit.length; i++) {
				tempTier = codeSplit[i].split("|");
				for (var c = 1; c < tempTier.length; c++)
					tempTier[c] = Number(tempTier[c]);
				processedCode[i] = tempTier;
			}
			$("tr").each( function() {
				$(this).remove();
			});
			console.log(processedCode);
			switch(processedCode[0][0]) {
				case "64": changeGame(game64);break;
				case "melee": changeGame(gameMelee);break;
				case "brawl": changeGame(gameBrawl);break;
				case "bminus": changeGame(gameBrawlMinus);break;
				case "zeus": changeGame(gameBrawlZeus);break;
				case "pm": changeGame(gamePM);break;
				case "SSBU": changeGame(gameSSBU);break;
				case "ssb4": changeGame(gameSmash4);break;
				case "ssb4r": changeGame(gameSSB4Renders);break;
				case "SSB4Inktober": changeGame(SSB4Inktober);break;
				case "USF2": changeGame(gameUSF2);break;
				case "SF33S": changeGame(gameSF33S);break;
				case "USF4": changeGame(gameUSF4);break;
				case "sfv": changeGame(gameSFV);break;
				case "ggrev": changeGame(gameGGREV);break;
				case "SSF1": changeGame(gameSSF1);break;
				case "SSF2Delta": changeGame(gameSSF2Delta);break;
				case "SSF2Photos": changeGame(gameSSF2Photos);break;
				case "MKX": changeGame(gameMKX);break;
					case "MK11": changeGame(gameMK11);break;
				case "DBFZ": changeGame(gameDBFZ);break;
				case "INJ": changeGame(gameINJ);break;
				case "INJ2": changeGame(gameINJ2);break;
				case "RoA": changeGame(gameRoA);break;
				case "bh": changeGame(gameBrawlhalla);break;
				case "ow": changeGame(gameOW);break;
				case "crusade": changeGame(gameCrusade);break;

			}
			for (var i = 1; i < processedCode.length; i++) {
				$("tbody").append(singleTier);
				$("tr:last-of-type").find(".labelHolder").css("background-color",colors[processedCode[i][1]]);
				$("tr:last-of-type").find(".label").html(processedCode[i][0]);
				for (var c = 2; c < processedCode[i].length; c++) {
					$("tr:last-of-type").find(".tier div:last-child").after(singleChar);
					$("tr:last-of-type").find(".tier div:last-child").css("background-image","url(img/"+processedCode[0]+"/"+currentGameChars[processedCode[i][c]]+".png)");
					$("tr:last-of-type").find(".tier div:last-child").attr("id",processedCode[i][c]);
					$("#char #"+processedCode[i][c]).remove();
				}
			}
		}
		
		function tierlistSize() {
			if ($("table").width > $("#tablewrap").width)
				$("#tablewrap").css("display","table-cell");
			else
				$("#tablewrap").css("display","block");
		}
		
		function alignPopup(popup) {
			return Math.floor(($(window).height() - popup.height())/2)+"px";
		}
		
		$(document).ready( function() {
			$("#char").html("<div></div>");
			if (localStorage.getItem("TierListMakerCode") === null)
				changeGame(gameSmash4);
			else {
				$("#exportcode").val(localStorage.getItem("TierListMakerCode"));
				loadCode(localStorage.getItem("TierListMakerCode"));
			}
			updateTiers();
			tierlistSize();
		});
		$(window).resize( function () {
			tierlistSize();
		})
		
		function maleCorrinMode() {
			$('<style>* { background: url(\'img/ssb4r/corrinm.png\'); }</style>').appendTo('head');
			changeGame(gameCorrinMode);
		}
	</script>
</body>
</html>
